# Chap09. 读写锁

## 悲观锁
效率低，不支持并发操作


## 乐观锁
版本号，支持并发操作


## 表锁 行锁
* 行锁会发生死锁

## 读锁 写锁
* 读锁：共享锁，会发生死锁
* 写锁：独占锁，会发生死锁


## 读写锁
1. 一个资源可以被多个线程访问，或者可以被一个写线程访问。但是不能同时存在读写线程，读写互斥，读读共享

### 1. 无锁
* 多线程抢夺资源 ==》 乱

### 2. 添加锁
synchronized and ReentrantLock ==> 独占，每次只能有一个操作

读读：1个，不能贡献
读写：1个
写写：1个

### 3. 读写锁，ReentrantReadWriteLock
读读，可以共享，提升性能，同时多人进行读操作
写写，1个

缺点：
1. 造成锁饥饿，一直读，没有写操作
2. 读时，不能写，只能读完成之后，才可以写；自己写的时候，自己可以读


## 读写锁降级
锁降级：
1. 将写入锁，降级为读锁。获取写锁 ==> 获取读锁 ==> 释放写锁 ==> 释放读锁
